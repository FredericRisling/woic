---
import { getEntry } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';
import Header from '../../components/layout/Header.astro';
import Footer from '../../components/layout/Footer.astro';
import Hero from '../../components/ui/Hero.astro';
import Section from '../../components/ui/Section.astro';
import Card from '../../components/ui/Card.astro';

const lang = 'de';
const pageData = await getEntry('pages', `${lang}/events`);
---

<BaseLayout
  title={pageData.data.meta.title}
  description={pageData.data.meta.description}
  lang={lang}
>
  <Header slot="default-header" lang={lang} />

  <Hero
    title={pageData.data.hero.title}
    subtitle={pageData.data.hero.subtitle}
  />

  {pageData.data.sections.map(section => {
    if (section.type === 'events') {
      return (
        <Section title={section.title} background={section.background}>
          <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6 max-w-6xl mx-auto">
            {section.events.map(event => (
              <Card>
                <div class="mb-4">
                  <span class={`inline-block px-3 py-1 ${
                    event.badgeColor === 'primary'
                      ? 'bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-300'
                      : 'bg-accent-100 dark:bg-accent-900/30 text-accent-700 dark:text-accent-300'
                  } text-sm font-medium rounded-full`}>
                    {event.badge}
                  </span>
                </div>
                <h3 class="text-xl font-bold mb-2 text-neutral-900 dark:text-neutral-100">
                  {event.title}
                </h3>
                <p class="text-sm text-neutral-500 dark:text-neutral-400 mb-3">
                  {event.time}
                </p>
                <p class="text-neutral-600 dark:text-neutral-400">
                  {event.description}
                </p>
                {event.location && (
                  <p class="text-sm text-neutral-500 dark:text-neutral-400 mt-3">
                    üìç {event.locationUrl
                      ? <a href={event.locationUrl} target="_blank" rel="noopener noreferrer" class="underline hover:text-primary-600">{event.location}</a>
                      : event.location}
                  </p>
                )}
              </Card>
            ))}
          </div>
        </Section>
      );
    }

    if (section.type === 'text') {
      return (
        <Section background={section.background}>
          <div class="max-w-2xl mx-auto text-center">
            <h2 class="text-2xl font-bold mb-4 text-neutral-900 dark:text-neutral-100">
              {section.title}
            </h2>
            <p class="text-lg text-neutral-600 dark:text-neutral-400">
              {section.content}
            </p>
          </div>
        </Section>
      );
    }
  })}

  <Footer slot="default-footer" lang={lang} />
</BaseLayout>
